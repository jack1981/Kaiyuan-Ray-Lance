ray:
  app_name: pac_quantile_top75
pipeline:
  type: LanceWriter
  output_path: /home/dataset/kaiyuan/quantile_stat/pac/top75
  child_configs:
    # 0.25*0.08=0.02
    - type: FilterByRatio
      keep_ratio: 0.08
      comparison: "larger"
      column: "pac_score"
      quantile_error: 0.001
      child_configs:
        - type: FilterByRatio
          keep_ratio: 0.25
          comparison: "smaller"
          column: "pac_score"
          quantile_error: 0.001
          child_configs:
            - type: LanceReader
              input_path: /home/dataset/cn_dataset/parquets/ZH_dedup_global
