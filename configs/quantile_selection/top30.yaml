ray:
  app_name: pac_quantile_top30
pipeline:
  type: LanceWriter
  output_path: /home/dataset/kaiyuan/quantile_stat/pac/top30
  child_configs:
    # 0.32 * 0.0625 = 0.02
    - type: FilterByRatio
      keep_ratio: 0.0625
      comparison: "smaller"
      column: "pac_score"
      quantile_error: 0.001
      child_configs:
        - type: FilterByRatio
          keep_ratio: 0.32
          comparison: "larger"
          column: "pac_score"
          quantile_error: 0.001
          child_configs:
            - type: LanceReader
              input_path: /home/dataset/cn_dataset/parquets/ZH_dedup_global
